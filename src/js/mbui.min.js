var common={init:function(){common.setColorTheme(),common.initInputClear()},initInputClear:function(){$(".mbui-text").on("focus input",function(){$(this).val()?$(".mbui-icon-input-clear").addClass("show"):$(".mbui-icon-input-clear").removeClass("show")}),$(".mbui-text").on("blur",function(){$(".mbui-icon-input-clear").removeClass("show")})},initHeaderTransparent:function(){var t=0,n=0;$(window).scroll(function(){0<(t=$(this).scrollTop())?$(".mbui-header--transparent").addClass("mbui-header--scroll"):$(".mbui-header--transparent").removeClass("mbui-header--scroll"),n=1<t/150?1:t/100,$(".mbui-header--transparent").css({background:"rgba(255,255,255,"+n+")"})})},setColorTheme:function(){localStorage.getItem("theme")&&$("body").addClass(localStorage.getItem("theme"))},goPage:function(t){location.href=t},closeScroll:function(){$("body").removeClass("mbui-ovh")},openScroll:function(){$("body").addClass("mbui-ovh")},openActionsheet:function(t){$("#"+t).addClass("active"),common.closeScroll()},closeActionsheet:function(t){$("#"+t).removeClass("active"),common.openScroll()},openSlidePage:function(t){$("#"+t).addClass("active"),common.closeScroll()},closeSlidePage:function(t){$("#"+t).removeClass("active"),common.openScroll()},openDialog:function(t){$("#"+t).addClass("active"),this.openScroll()},closeDialog:function(t){$("#"+t).removeClass("active"),common.closeScroll()},openOfcanvas:function(){$("body").addClass("mbui-ovh has-ofcanvas ofcanvas-active"),$("body").append('<div class="mbui-overlay active" style="background: rgba(0,0,0,.4);" id="ofcanvas-overlay" onclick="javascript:common.closeOfcanvas();"></div>')},closeOfcanvas:function(){$("body").removeClass("mbui-ovh ofcanvas-active"),$("body").find("#ofcanvas-overlay").remove()},initCollapse:function(){$(".mbui-collapse").on("click",".mbui-collapse-item__tle",function(){void 0===$(this).parents(".mbui-collapse").attr("accordion")?$(this).parent().toggleClass("mbui-collapse-item--expanded"):($(this).parent().toggleClass("mbui-collapse-item--expanded"),$(this).parent().siblings().removeClass("mbui-collapse-item--expanded"))})},initPopover:function(){$(".js-popover").on("click",function(t){t.stopPropagation(),$("[data-popover]").toggleClass("mbui-hide").toggleClass("animated")}),$(document).on("click",function(){$("[data-popover]").addClass("mbui-hide").removeClass("animated")})},initFav:function(){$(".js-fav").on("click",function(){$(this).hasClass("active")?($(this).removeClass("active"),$(this).find("span").html("收藏"),new Toast({content:"取消收藏",duration:2e3})):($(this).addClass("active"),$(this).find("span").html("已收藏"),new Toast({type:"success",content:"收藏成功",duration:2e3}))})},initCountdown:function(t,n,e){e||(e=1),common.countdownBase(t,n,e),setInterval(function(){common.countdownBase(t,n,e)},1e3)},countdownBase:function(t,n,e){var i=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2}) ([0-9]{2}):([0-9]{2}):([0-9]{2})$/);if(null==i)return console.log("时间格式错误"),!1;var a=parseInt(i[1]);if(a<1e3)return console.log("时间格式错误"),!1;var s=parseInt(i[2]),o=parseInt(i[3]),l=parseInt(i[4]);if(l<0||24<l)return console.log("时间格式错误"),!1;if((v=parseInt(i[5]))<0||60<v)return console.log("时间格式错误"),!1;var r=parseInt(i[6]);if(r<0||60<r)return console.log("时间格式错误"),!1;var c=new Date(a,s-1,o,l,v,r)-new Date;if(0<c){var m=parseInt(c/1e3/60/60/24,10);if(2==e||3==e)var d=parseInt(c/1e3/60/60%24,10)+24*m;else d=parseInt(c/1e3/60/60%24,10);var u=parseInt(c/1e3/60%60,10),p=parseInt(c/1e3%60,10)}else m=0,d=0,u=0,p=0;var f="",b=m.toString(),h="";if(b.length<2)h+="<span>0</span><span>"+b+"</span>";else for(var v=0;v<b.length;v++)h+="<span>"+b[v]+"</span>";var g=d.toString(),y="";if(g.length<2)y+="<span>0</span><span>"+g+"</span>";else for(v=0;v<g.length;v++)y+="<span>"+g[v]+"</span>";var w=u.toString(),C="";if(w.length<2)C+="<span>0</span><span>"+w+"</span>";else for(v=0;v<w.length;v++)C+="<span>"+w[v]+"</span>";var x=p.toString(),S="";if(x.length<2)S+="<span>0</span><span>"+x+"</span>";else for(v=0;v<x.length;v++)S+="<span>"+x[v]+"</span>";switch(e){case 1:f+=h+"天"+y+"时"+C+"分"+S+"秒";break;case 2:f+=y+"时"+C+"分"+S+"秒";break;case 3:f+=y+":"+C+":"+S;break;case 4:f+=C+":"+S;break;default:f+=h+"天"+y+"时"+C+"分"+S+"秒"}$(n).addClass("mbui-countdown"),$(n).html(f)},initStarRating:function(){$(".js-star").on("click",".mbui-star-rating__item",function(){$(this).parent().find(".mbui-star-rating__item").removeClass("mbui-star-rating__item--active"),$(this).parent().find(".mbui-star-rating__item:lt("+$(this).data("val")+")").addClass("mbui-star-rating__item--active"),$(this).parent().find("input:hidden").val($(this).data("rating")),$(this).parent().siblings(".mbui-star-rating__val").html($(this).data("rating"))})},initSummary:function(){$(".js-summary").on("click",".mbui-summary__toggle",function(){var t=$(this).parent(),n=$(this);t.hasClass("mbui-summary--open")?(t.removeClass("mbui-summary--open"),n.find(".mbui-summary__toggle-txt").html("查看全部")):(t.addClass("mbui-summary--open"),n.find(".mbui-summary__toggle-txt").html("收起"))})}},numberKeypad={initNumberKeyboard:function(t,n,e){n&&t.on("click",function(){t.NumberKeypad({random:!!n.random&&n.random,zIndex:n.zIndex?n.zIndex:1e3,ciphertext:0!=n.ciphertext||n.ciphertext,dot:0!=n.dot||n.dot,currency:!!n.currency&&n.currency,max:!!n.max&&n.max,digits:n.digits?n.digits:2,type:"number"==n.type?n.type:"password",callback:e})})},initPasswordInput:function(t,n,e){t.on("click",function(){t.NumberKeypad({random:!0,zIndex:n,callback:e})})}},swiper={initSwiperBanner:function(){new Swiper("[data-swiper-banner]",{pagination:{el:".swiper-pagination",clickable:!0},autoplay:{delay:3e3,stopOnLastSlide:!1,disableOnInteraction:!1},loop:!0})},initSwiperNotice:function(){new Swiper("[data-swiper-notice]",{direction:"vertical",slidesPerView:1,autoplay:{delay:3e3,stopOnLastSlide:!1,disableOnInteraction:!1},loop:!0})},initSwiperTab:function(t,n,e){var i=new Swiper(n,{slidesPerView:t,observer:!0,observeParents:!0}),a=new Swiper(e,{autoHeight:!0,observer:!0,observeParents:!0,on:{slideChangeTransitionEnd:function(){n.find("li").removeClass("active"),i.slideTo(this.activeIndex,500,!1),n.find("li:eq("+this.activeIndex+")").addClass("active")}}});n.find("li").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),a.slideTo($(this).index(),500,!1)})},initTabSticky:function(){var n=!1,e=0,i=0,a=0;function t(){var t=$(window).scrollTop();$("[data-tab-sticky]")[0]&&$("[data-tab-sticky]").each(function(){e=$(this).offset().top,a=e+$(this).outerHeight()-$(this).find(".mbui-swiper-tab-tle").outerHeight()-i,e<=t+i?$(this).find(".mbui-swiper-tab-tle").addClass("mbui-swiper-tab-tle--fixed").css("top",i):$(this).find(".mbui-swiper-tab-tle").removeClass("mbui-swiper-tab-tle--fixed").removeAttr("style"),a<=t&&$("[data-tab-sticky]").find(".mbui-swiper-tab-tle").removeClass("mbui-swiper-tab-tle--fixed").css({top:"auto",bottom:0})}),n=!1}$(".mbui-header")[0]&&(i=$(".mbui-header").outerHeight()),window.addEventListener("scroll",function(){n||(requestAnimationFrame(t),n=!0)},!1)}},mobiscroll={initSelect:function(t,n){$("."+t).mobiscroll().select({theme:"ios",lang:"zh",display:"bottom",minWidth:200,inputClass:n})},initArea:function(t,n){$("#"+t).mobiscroll().treelist({theme:"ios",lang:"zh",display:"bottom",width:[160,160,160],placeholder:"请点击选择地区",inputClass:n})},initDateRange:function(t,n){$("."+t).mobiscroll().range({theme:"mobiscroll",lang:"zh",display:"bottom",dateFormat:"yy.mm.dd",onSet:n})},initDate:function(t){var n=new Date;$("."+t).mobiscroll().date({theme:"ios",lang:"zh",display:"bottom",min:new Date(n.getFullYear(),n.getMonth(),n.getDate()),dateFormat:"yy-mm-dd",setText:"确定",cancelText:"取消"})},initBirthdayDate:function(t,n){var e=new Date(t);$("."+n).mobiscroll().date({theme:"ios",lang:"zh",display:"bottom",min:new Date(e.getFullYear(),e.getMonth(),e.getDate()),dateFormat:"yy-mm-dd",setText:"确定",cancelText:"取消"})},initTime:function(t,n){new Date;$("."+t).mobiscroll().time({theme:"ios",lang:"zh",display:"bottom",headerText:!1,maxWidth:90,timeFormat:"HH:ii",timeWheels:"HHii",setText:"确定",cancelText:"取消",onSet:n})},initDateTime:function(t){var n=new Date;$("."+t).mobiscroll().datetime({theme:"ios",lang:"zh",display:"bottom",min:new Date(n.getFullYear(),n.getMonth(),n.getDate()),dateFormat:"yy-mm-dd",setText:"确定",cancelText:"取消",timeWheels:"HHii"})}},cellSwipe={init:function(){touch.on(".mbui-line-list--swipe .mbui-line-item .item-tt","drag",function(t){console.log($(this).siblings(".mbui-swipe-btn-group").html());var n=$(this).siblings(".mbui-swipe-btn-group").outerWidth();t.distanceX<0?($(this).css({"-webkit-transform":"translate3d(-"+n+"px,0,0)",transform:"translate3d(-"+n+"px,0,0)"}),$(this).parent().removeClass("no-swipe").addClass("is-swipe"),$(this).parent().siblings().find(".item-tt").removeAttr("style"),$(this).parent().siblings().removeClass("is-swipe").addClass("no-swipe")):($(this).removeAttr("style"),$(this).parent().removeClass("is-swipe").addClass("no-swipe"))})}},smartPhoto={init:function(t){t?$(".js-img-viwer").SmartPhoto({arrows:0!=t.arrows||t.arrows,nav:0!=t.nav||t.nav,useOrientationApi:0!=t.useOrientationApi||t.useOrientationApi,resizeStyle:"fit"==t.resizeStyle?t.resizeStyle:"fill",animationSpeed:t.animationSpeed?t.animationSpeed:300,forceInterval:t.forceInterval?t.forceInterval:10}):$(".js-img-viwer").SmartPhoto()}},masonry={init:function(){$(".mbui-waterfall").masonry({itemSelector:".mbui-waterfall__item"})}};$(function(){common.init()});var Msgbox=function(r){var a='<span class="ft-btn ft-btn--primary js-btn-alert">确定</span>',o='<span class="ft-btn js-btn-cancel">取消</span><span class="ft-btn ft-btn--primary js-btn-confirm">确定</span>',l='<span class="ft-btn js-btn-cancel">取消</span><span class="ft-btn ft-btn--primary js-btn-prompt">确定</span>',t=function(){this.cfg={content:"",text4AlertBtn:"确定",text4Title:"提示",handler4AlertBtn:null,handler4ConfirmBtn:null,handler4CancelBtn:null,handler4PromptConfirmBtn:null},this.handlers={},this.get=function(t){return this.cfg[t]},this.set=function(t,n){this.cfg[t]=n},this.init()};return t.prototype={init:function(){this.createDom()},on:function(t,n){void 0===this.handlers[t]&&(this.handlers[t]=[]),this.handlers[t].push(n)},fire:function(t,n){if(this.handlers[t]instanceof Array)for(var e=this.handlers[t],i=0,a=e.length;i<a;i++)e[i](n)},createDom:function(){var t=r("body"),n=null,e=null,i=null,a=null,s=null,o=null,l=null;0==r(".mbui-msgbox-wrap").length&&(n=r('<section class="mbui-msgbox-wrap">'),e=r('<div class="mbui-overlay"></div>'),i=r('<div class="mbui-msgbox">'),s=r('<h4 class="mbui-msgbox-tle">'),a=r('<div class="mbui-msgbox-bd">'),o=r('<p class="bd-txt">'),l=r('<footer class="mbui-msgbox-ft">'),n.appendTo(t),e.appendTo(n),i.appendTo(n),s.appendTo(i),a.appendTo(i),o.appendTo(a),l.appendTo(i)),this.set("msgboxWrap",r(".mbui-msgbox-wrap"))},alert:function(t){var n=r.extend(this.cfg,t),e=this.get("msgboxWrap"),i=this;n.content="string"==typeof n.content?n.content:n.content.toString(),e.find(".mbui-msgbox-tle").html(n.text4Title),e.find(".bd-txt").html(n.content),void 0===n.text4AlertBtn?e.find(".mbui-msgbox-ft").html(a):e.find(".mbui-msgbox-ft").html('<span class="ft-btn ft-btn--primary js-btn-alert">'+n.text4AlertBtn+"</span>"),e.addClass("active"),e.find(".js-btn-alert").on("click",function(){e.removeClass("active"),i.fire("alert"),i=null}),n.handler4AlertBtn&&this.on("alert",n.handler4AlertBtn)},confirm:function(t){var n=r.extend(this.cfg,t),e=this.get("msgboxWrap"),i=this;n.content="string"==typeof n.content?n.content:n.content.toString(),e.find(".mbui-msgbox-tle").html(n.text4Title),e.find(".bd-txt").html(n.content),e.find(".mbui-msgbox-ft").html(o),e.addClass("active");var a=e.find(".js-btn-cancel"),s=e.find(".js-btn-confirm");a.on("click",function(){e.removeClass("active"),i.fire("cancel"),i=null}),s.on("click",function(){e.removeClass("active"),i.fire("confirm"),i=null}),e.find(".mbui-overlay").on("click",function(){e.removeClass("active"),i=null}),n.handler4CancelBtn&&this.on("cancel",n.handler4CancelBtn),n.handler4ConfirmBtn&&this.on("confirm",n.handler4ConfirmBtn)},prompt:function(t){var n=r.extend(this.cfg,t),e=this.get("msgboxWrap"),i=this;n.content="string"==typeof n.content?n.content:n.content.toString(),e.find(".mbui-msgbox-tle").html(n.text4Title),e.find(".mbui-msgbox-bd").html('<input class="prompt-input">'),setTimeout(function(){e.find(".mbui-msgbox-bd").find(".prompt-input").focus()},200),e.find(".mbui-msgbox-ft").html(l),e.addClass("active");var a=e.find(".js-btn-cancel"),s=e.find(".js-btn-prompt");a.on("click",function(){e.remove(),i.fire("cancel"),i=null}),s.on("click",function(){r("#promptInput")[0]?r("#promptInput").val(r(".prompt-input").val()):r("body").append('<input type="hidden" id="promptInput" value="'+r(".prompt-input").val()+'">'),e.remove(),i.fire("prompt"),i=null}),e.find(".mbui-overlay").on("click",function(){e.remove(),i=null}),n.handler4CancelBtn&&this.on("cancel",n.handler4CancelBtn),n.handler4ConfirmBtn&&this.on("prompt",n.handler4ConfirmBtn)}},t}($),Toast=function(l){var t=function(e){e=e||{};this.get=function(t){return e[t]},this.set=function(t,n){e[t]=n},this.init(e)};return t.prototype={init:function(t){var n=t.type?t.type:"normal",e=t.duration?t.duration:void 0,i=t.html?t.html:void 0;this.createDom(n,i,t.content),this.bindEvent(e)},createDom:function(t,n,e){l("body");if(0==l(".mbui-toast-wrap").length){var i=l('<section class="mbui-toast-wrap">'),a=l('<div class="mbui-toast">'),s=l('<p class="mbui-toast-txt">');s.html(e),i.appendTo("body"),a.appendTo(i);var o="";"success"==t?o=l('<svg class="mbui-icon" aria-hidden="true"><use xlink:href="#icon-success"></use></svg>'):"fail"==t?o=l('<svg class="mbui-icon" aria-hidden="true"><use xlink:href="#icon-shanchu2"></use></svg>'):"loading"==t?o=l('<i class="mbui-toast-icon icon-loading">'):"custom"==t&&(o=l(n)),o&&o.appendTo(a),s.appendTo(a)}this.set("toastWrap",l(".mbui-toast-wrap"))},hide:function(){var t=this;t.get("toastWrap").remove(),t=null},bindEvent:function(t){var n=this,e=n.get("toastWrap");e.addClass("active"),void 0!==t&&setTimeout(function(){e.remove(),n=null},t)}},t}($);